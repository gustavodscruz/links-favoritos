<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Link - Links Favoritos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/link-add.css">
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container">
            <a class="navbar-brand" href="/dashboard">üîó Links Favoritos</a>
            <div class="d-flex align-items-center">
                <a class="btn btn-outline-primary" href="/">Voltar</a>
            </div>
        </div>
    </nav>

    <div class="container mt-4 mb-5">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">‚ûï Adicionar novo link</h5>

                {{#success}}
                <div class="alert alert-success" role="alert">{{success}}</div>
                {{/success}}

                {{#error}}
                <div class="alert alert-danger" role="alert">{{error}}</div>
                {{/error}}

                <form action="/link/add" method="post">
                    {{> partials/csrf}}

                    <div class="mb-3">
                        <label for="name" class="form-label">Nome</label>
                        <input type="text" id="name" name="name" class="form-control"
                            placeholder="Nome do link (opcional)">
                        {{#nameError}}
                        <div class="invalid-feedback d-block">{{nameError}}</div>
                        {{/nameError}}
                    </div>

                    <div class="mb-3">
                        <label for="url" class="form-label">URL</label>
                        <input type="url" id="url" name="url" class="form-control" placeholder="https://exemplo.com"
                            required>
                        {{#urlError}}
                        <div class="invalid-feedback d-block">{{urlError}}</div>
                        {{/urlError}}
                    </div>

                    <div class="mb-3">
                        <label for="description" class="form-label">Descri√ß√£o</label>
                        <textarea id="description" name="description" class="form-control" rows="3"
                            placeholder="Descri√ß√£o do link (opcional)"></textarea>
                        {{#descriptionError}}
                        <div class="invalid-feedback d-block">{{descriptionError}}</div>
                        {{/descriptionError}}
                    </div>

                    <!-- <label for="colorPicker">Escolha uma cor:</label>
                    <input type="color" id="colorPicker" name="colorPicker" value="#ff0000"> -->


                    <div class="mb-3 form-check">
                        <!-- hidden fallback para garantir false quando n√£o marcado -->
                        <input type="hidden" name="favorited" value="false">
                        <input class="form-check-input" type="checkbox" id="favorited" name="favorited" value="true">
                        <label class="form-check-label" for="favorited">Marcar como favorito</label>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Categorias</label>
                        <div class="category-checkbox-group p-3 border rounded bg-light">
                            <div class="row g-2">
                                {{#listagem-categorias}}
                                <div class="col-md-6 col-lg-4">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" name="categorias" value="{{id}}"
                                            id="cat-{{id}}">
                                        <label class="form-check-label" for="cat-{{id}}">
                                            {{name}}
                                        </label>
                                    </div>
                                </div>
                                {{/listagem-categorias}}
                            </div>
                            {{^listagem-categorias}}
                            <div class="text-muted small">Nenhuma categoria dispon√≠vel. <a href="/categoria/add">Criar
                                    categoria</a></div>
                            {{/listagem-categorias}}
                        </div>
                        <div class="form-text">Selecione uma ou mais categorias para organizar seu link.</div>
                    </div>

                    <div class="d-grid">
                        <button class="btn btn-primary btn-lg" type="submit">Salvar Link</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- lista de links existentes (substitu√≠da por cards) -->
        <div class="mt-4">
            <h5 class="mb-3">Seus links</h5>
            <div class="row g-4">
                {{#links}}
                <div class="col-12 col-md-6 col-lg-4">
                    <div class="card h-100">
                        {{#thumbnailPreview}}
                        <img src="{{thumbnailPreview}}" class="card-img-top link-preview" alt="preview">
                        {{/thumbnailPreview}}
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-title">{{#name}}{{name}}{{/name}}</h6>
                            <p class="card-text text-truncate mb-2"><a href="{{url}}" target="_blank">{{url}}</a></p>
                            <div class="mb-2">
                                {{#categorias}}
                                <span class="badge bg-primary text-light me-1">{{name}}</span>
                                {{/categorias}}
                            </div>
                            <div class="mt-auto d-flex justify-content-end">
                                <a href="/links/edit?id={{id}}" class="btn btn-sm btn-outline-primary me-2">‚úèÔ∏è</a>
                                <form action="/links/delete" method="post" class="m-0">
                                    <input type="hidden" name="id" value="{{id}}">
                                    {{> partials/csrf}}
                                    <button class="btn btn-sm btn-danger" onclick="return confirm('Excluir link?')">üóëÔ∏è</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                {{/links}}
                {{^links}}
                <div class="col-12 text-center text-muted">
                    Nenhum link encontrado.
                </div>
                {{/links}}
            </div>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>
</body>

</html>